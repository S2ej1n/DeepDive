<!DOCTYPE html>
<html lang="en">
  <head>
    <title>intersection observer</title>
    <meta charset="utf-8" />
    <style>
      img {
          width: 400px;
          height: 300px;
          display: block;
          margin: 10px auto;
      }
  </style>
  </head>

  <body>
    <img src='https://via.placeholder.com/400x300'
      data-src='https://ik.imagekit.io/demo/img/image4.jpeg?tr=w-400,h-300'>
    <img src='https://via.placeholder.com/400x300'
      data-src='https://ik.imagekit.io/demo/img/image4.jpeg?tr=w-400,h-300'>
    <img src='https://via.placeholder.com/400x300'
      data-src='https://ik.imagekit.io/demo/img/image4.jpeg?tr=w-400,h-300'>
    <img src='https://via.placeholder.com/400x300'
      data-src='https://ik.imagekit.io/demo/img/image4.jpeg?tr=w-400,h-300'>

    <script>
      const observer =  new IntersectionObserver(
        function(entries, observer) {
          console.log(entries);
          entries.forEach(entry => {
            if(entry.isIntersecting) {
              // src에 데이터 src를 넣으면됨
              entry.target.src = entry.target.dataset.src;

              // 관찲 멈춤
              observer.unobserve(entry.target);
            }
          })
        },
        {
          threshold: 1,
        })

    const imgs = document.querySelectorAll('img');
    imgs.forEach((img)=>{
      observer.observe(img);
    })
    </script>
  </body>
</html>